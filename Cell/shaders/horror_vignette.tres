[gd_resource type="Shader" load_steps=2 format=2]

[resource]
code = "shader_type canvas_item;\n\nuniform float vignette_strength : hint_range(0.0, 2.0) = 1.2;\nuniform float vignette_softness : hint_range(0.0, 2.0) = 0.8;\nuniform float warp_amount      : hint_range(0.0, 0.1) = 0.02;\nuniform float grain_amount     : hint_range(0.0, 1.0) = 0.08;\nuniform float grain_size       : hint_range(0.1, 10.0) = 1.5;\nuniform float desaturate       : hint_range(0.0, 1.0) = 0.35;\nuniform vec3  tint_color       : hint_color = vec3(0.9, 0.8, 0.95);\n\nuniform sampler2D screen_texture : hint_screen_texture;\n\nfloat hash(vec2 p) {\n\treturn fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid fragment() {\n\t// Base screen color\n\tvec2 uv = SCREEN_UV;\n\n\t// Subtle barrel-ish warp for unease\n\tvec2 centered = uv * 2.0 - 1.0;\n\tfloat r2 = dot(centered, centered);\n\tcentered *= 1.0 + warp_amount * r2;\n\tuv = centered * 0.5 + 0.5;\n\n\tvec4 col = texture(screen_texture, uv);\n\n\t// Vignette (dark edges)\n\tvec2 v_uv = uv - 0.5;\n\tfloat dist = length(v_uv * vec2(1.1, 1.2)); // slightly stronger vertically\n\tfloat vig = smoothstep(vignette_softness, vignette_strength + vignette_softness, dist);\n\tcol.rgb *= (1.0 - vig);\n\n\t// Desaturate + tint\n\tfloat gray = dot(col.rgb, vec3(0.299, 0.587, 0.114));\n\tcol.rgb = mix(col.rgb, vec3(gray), desaturate);\n\tcol.rgb *= tint_color;\n\n\t// Film grain\n\tvec2 grain_uv = UV * grain_size + vec2(TIME * 7.31, TIME * 3.17);\n\tfloat noise = hash(grain_uv);\n\tfloat grain = (noise - 0.5) * 2.0 * grain_amount;\n\tcol.rgb += grain;\n\n\tCOLOR = clamp(col, 0.0, 1.0);\n}"
